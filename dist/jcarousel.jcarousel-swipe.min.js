!function(e){"use strict";e.jCarousel.plugin("jcarouselSwipe",{_init:function(){var e=this;this.carousel().on("jcarousel:reloadend",function(){e._reload()})},_create:function(){this._instance=this.carousel().data("jcarousel"),this._instance._element.css("touch-action","pan-y"),this._carouselOffset=this.carousel().offset().left+parseInt(this.carousel().css("border-left-width"))+parseInt(this.carousel().css("padding-left")),this._slidesCount=this._instance.items().length,this.carousel().find("img").attr("draggable",!1),this._destroy(),this._instance.items().length>this._instance.fullyvisible().length&&this._initGestures()},_initGestures:function(){function t(t){t=t.originalEvent||t||window.event,r=n(t),e(document).on("touchmove.jcarouselSwipe mousemove.jcarouselSwipe",i),e(document).on("touchend.jcarouselSwipe touchcancel.jcarouselSwipe mouseup.jcarouselSwipe",s)}function i(t){var i,s;return t=t.originalEvent||t||window.event,l=n(t),u&&t.preventDefault(),Math.abs(r.y-l.y)>10&&!u?void e(document).off("touchmove.jcarouselSwipe mousemove.jcarouselSwipe"):void(!f&&Math.abs(r.x-l.x)>10&&(i=r.x-l.x,u||(u=!0,c._addClones(),c._currentLeft=c._getListPosition(),a=c._instance.items().last(),o=-1*(a.position().left+a.outerWidth()-c._instance.carousel().innerWidth())),s="circular"===c._instance._options.wrap?c._currentLeft-i:Math.min(0,Math.max(c._currentLeft-i,o)),c._setListPosition({left:s+"px"})))}function s(t){if(t=t.originalEvent||t||window.event,u){var i=c._getNewTarget(r.x-l.x>0);i="circular"===c._instance._options.wrap?i.relative:i["static"],e(t.target).on("click.disable",function(t){t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault(),e(t.target).off("click.disable")}),c._removeClones(),c._instance._items=null,f=!0,c._instance.scroll(i,function(){u=!1,f=!1})}e(document).off("touchmove.jcarouselSwipe mousemove.jcarouselSwipe"),e(document).off("touchend.jcarouselSwipe touchcancel.jcarouselSwipe mouseup.jcarouselSwipe")}function n(e){return void 0!==e.touches?{x:e.touches[0].pageX,y:e.touches[0].pageY}:void 0!==e.pageX?{x:e.pageX,y:e.pageY}:{x:e.clientX,y:e.clientY}}var o,a,c=this,r={},l={},u=!1,f=!1;this._element.on("touchstart.jcarouselSwipe mousedown.jcarouselSwipe",t)},_getNewTarget:function(e){for(var t=this._instance.target(),i=this._instance.index(t),s=0;;){if(!t.length||e&&t.offset().left-this._carouselOffset>=0||!e&&t.offset().left-this._carouselOffset<=0)break;if(e){if(t=t.next(),!t.length)break;i=i+1>=this._slidesCount?0:i+1}else{if(t=t.prev(),!t.length)break;i=0>i-1?this._slidesCount-1:i-1}s++}return{"static":i,relative:(e?"+":"-")+"="+s}},_getListPosition:function(){return this._instance.list().position()[this._instance.lt]},_setListPosition:function(e){var t=this._instance.options("transitions"),i=!!t.transforms,s=!!t.transforms3d,n={};s?n.transform="translate3d("+(e.left||0)+","+(e.top||0)+",0)":i?n.transform="translate("+(e.left||0)+","+(e.top||0)+")":n=e,this._instance.list().css(n)},_addClones:function(){var t,i,s,n=this,o=n._instance.items(),a=n._instance.first(),c=n._instance.last(),r=e(window).width(),l=[],u=[],f=n._getListPosition();if("circular"!==this._instance._options.wrap)return!1;for(i=0,s=0,t=a;r>i;)t=t.prev(),0===t.length?(s=--s<-o.length?-1:s,i+=n._instance.dimension(o.eq(s)),l.push(o.eq(s).clone().attr("data-jcarousel-clone",!0))):i+=n._instance.dimension(t);for(f=Math.min(f,-i)+"px",i=0,s=-1,t=c;r>i;)t=t.next(),0===t.length?(s=++s>o.length-1?0:s,i+=n._instance.dimension(o.eq(s)),u.push(o.eq(s).clone().attr("data-jcarousel-clone",!0))):i+=n._instance.dimension(t);n._instance._items.first().before(l.reverse()),n._instance._items.last().after(u),n._instance.move({left:f})},_removeClones:function(){var e,t=this._instance.first().position()[this._instance.lt];this._instance.list().find("[data-jcarousel-clone]").remove(),e=Math.abs(this._instance.first().position()[this._instance.lt]-t),e&&this._instance.move({left:this._getListPosition()+e+"px"})},_destroy:function(){this._element.off("touchstart.jcarouselSwipe mousedown.jcarouselSwipe"),e(document).off("touchmove.jcarouselSwipe mousemove.jcarouselSwipe touchend.jcarouselSwipe touchcancel.jcarouselSwipe mouseup.jcarouselSwipe")},_reload:function(){this._create()}})}(jQuery);